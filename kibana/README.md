# Kibana ç›‘æŽ§ä»ªè¡¨ç›˜ä½¿ç”¨è¯´æ˜Ž

## ðŸ“Š é¡¹ç›®æ¦‚è¿°

æœ¬Kibanaä»ªè¡¨ç›˜æ˜¯ä¸€ä¸ª**Webåº”ç”¨å®žæ—¶ç›‘æŽ§ç³»ç»Ÿ**ï¼ŒåŸºäºŽå®Œæ•´çš„ELKæŠ€æœ¯æ ˆï¼ˆElasticsearchã€Logstashã€Filebeatã€Kibanaï¼‰æž„å»ºã€‚å®ƒèƒ½è‡ªåŠ¨æ”¶é›†ã€è§£æžå’Œå¯è§†åŒ–Webåº”ç”¨çš„æ—¥å¿—æ•°æ®ï¼Œæä¾›å®žæ—¶ä¸šåŠ¡ç›‘æŽ§å’Œæ•…éšœæŽ’æŸ¥èƒ½åŠ›ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼šåªéœ€è®¿é—®ä¸€ä¸ªURLï¼Œå³å¯æŽŒæ¡åº”ç”¨å¥åº·çŠ¶å†µã€æµé‡è¶‹åŠ¿å’Œé”™è¯¯è¯¦æƒ…ï¼Œæ— éœ€ç™»å½•å¤šå°æœåŠ¡å™¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚

---

## ðŸš€ å¿«é€Ÿè®¿é—®

### ä»ªè¡¨ç›˜ä¸»ç•Œé¢

ç›´æŽ¥ç‚¹å‡»ä»¥ä¸‹é“¾æŽ¥è®¿é—®ç›‘æŽ§ä¸­å¿ƒï¼š
ðŸ‘‰ **[Webåº”ç”¨ç›‘æŽ§ä»ªè¡¨ç›˜](http://localhost:5601/app/dashboards#/list?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-15d,to:now))&sort=title&sortdir=desc)**

![1765123741768](image/README/1765123741768.png)

![1765124225721](image/README/1765124225721.png)

> **éƒ¨ç½²æç¤º**ï¼šåœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œè¯·å°† `localhost` æ›¿æ¢ä¸ºå®žé™…æœåŠ¡å™¨åœ°å€æˆ–åŸŸåã€‚

### ç›¸å…³æœåŠ¡è®¿é—®

- **Kibanaä¸»é¡µ**ï¼šhttp://localhost:5601
- **Elasticsearch API**ï¼šhttp://localhost:9200
- **Webåº”ç”¨ç¤ºä¾‹**ï¼šhttp://localhost:8000
- **Logstashç›‘æŽ§**ï¼šhttp://localhost:9600

---

## ðŸ“ˆ ä»ªè¡¨ç›˜åŠŸèƒ½è¯¦è§£

### 1. å®žæ—¶è¯·æ±‚é‡è¶‹åŠ¿å›¾ï¼ˆæŠ˜çº¿å›¾ï¼‰

**ä½ç½®**ï¼šä»ªè¡¨ç›˜é¡¶éƒ¨åŒºåŸŸ**åŠŸèƒ½**ï¼š

- å±•ç¤ºåº”ç”¨æ¯ç§’è¯·æ±‚é‡ï¼ˆQPSï¼‰éšæ—¶é—´çš„å˜åŒ–è¶‹åŠ¿
- å®žæ—¶åæ˜ æµé‡é«˜å³°å’Œä½Žè°·æ—¶æ®µ
- è‡ªåŠ¨æ¯10ç§’åˆ·æ–°ï¼Œå®žçŽ°å‡†å®žæ—¶ç›‘æŽ§

**å…³é”®æŒ‡æ ‡**ï¼šè¯·æ±‚è®¡æ•°ã€æ—¶é—´åˆ†å¸ƒ

### 2. HTTPçŠ¶æ€ç åˆ†å¸ƒå›¾ï¼ˆé¥¼å›¾/åœ†çŽ¯å›¾ï¼‰

**ä½ç½®**ï¼šä»ªè¡¨ç›˜å·¦ä¸‹æ–¹**åŠŸèƒ½**ï¼š

- ç›´è§‚å±•ç¤ºå„ç±»HTTPçŠ¶æ€ç çš„æ¯”ä¾‹åˆ†å¸ƒ
- å¿«é€Ÿè¯†åˆ«é”™è¯¯è¯·æ±‚ï¼ˆ4xxã€5xxï¼‰å æ¯”
- ç‚¹å‡»ä»»æ„è‰²å—å¯è”åŠ¨ç­›é€‰å…¶ä»–å›¾è¡¨

**å…³é”®å­—æ®µ**ï¼š`status_code` (200, 404, 500ç­‰)

### 3. é”™è¯¯è¯¦æƒ…åˆ†æžè¡¨ï¼ˆæ•°æ®è¡¨ï¼‰

**ä½ç½®**ï¼šä»ªè¡¨ç›˜å³ä¸‹æ–¹**åŠŸèƒ½**ï¼š

- åˆ—å‡ºå…·ä½“å‡ºé”™çš„æŽ¥å£è·¯å¾„å’Œé”™è¯¯ç±»åž‹
- æŒ‰é”™è¯¯æ•°é‡æŽ’åºï¼Œå¿«é€Ÿå®šä½é—®é¢˜æœ€ä¸¥é‡çš„æŽ¥å£
- æ”¯æŒä¸¤çº§ä¸‹é’»ï¼šæŽ¥å£è·¯å¾„ â†’ å…·ä½“çŠ¶æ€ç 

**å…³é”®å­—æ®µ**ï¼š`url_path`ã€`status_code`ã€é”™è¯¯è®¡æ•°

---

## ðŸ”§ æ ¸å¿ƒåŠŸèƒ½æ“ä½œæŒ‡å—

### æ—¶é—´èŒƒå›´ç­›é€‰

1. åœ¨ä»ªè¡¨ç›˜å³ä¸Šè§’æ‰¾åˆ°æ—¶é—´é€‰æ‹©å™¨ï¼ˆé»˜è®¤æ˜¾ç¤º"è¿‡åŽ»15åˆ†é’Ÿ"ï¼‰
2. ç‚¹å‡»å¯é€‰æ‹©é¢„è®¾èŒƒå›´ï¼ˆ"ä»Šå¤©"ã€"æœ¬å‘¨"ã€"è¿‡åŽ»1å°æ—¶"ç­‰ï¼‰
3. æˆ–é€‰æ‹©"ç»å¯¹æ—¶é—´"æ‰‹åŠ¨è¾“å…¥ç²¾ç¡®æ—¶é—´èŒƒå›´

### è‡ªåŠ¨åˆ·æ–°è®¾ç½®

1. ä»ªè¡¨ç›˜å·²é¢„è®¾**æ¯10ç§’è‡ªåŠ¨åˆ·æ–°**
2. å¦‚éœ€è°ƒæ•´ï¼šç‚¹å‡»å³ä¸Šè§’"è‡ªåŠ¨åˆ·æ–°"æŒ‰é’®
3. é€‰æ‹©æ–°é—´éš”ï¼ˆ5ç§’ã€30ç§’ã€1åˆ†é’Ÿç­‰ï¼‰æˆ–æš‚åœè‡ªåŠ¨åˆ·æ–°

### å›¾è¡¨äº¤äº’ä¸Žä¸‹é’»

- **è”åŠ¨ç­›é€‰**ï¼šç‚¹å‡»é¥¼å›¾ä¸­ç‰¹å®šçŠ¶æ€ç ï¼Œå…¶ä»–å›¾è¡¨ä¼šåªæ˜¾ç¤ºè¯¥çŠ¶æ€ç çš„æ•°æ®
- **æŸ¥çœ‹è¯¦æƒ…**ï¼šç‚¹å‡»æ•°æ®è¡¨ä¸­çš„è¡Œï¼Œå¯åœ¨ä¸‹æ–¹æŸ¥çœ‹è¯¥é”™è¯¯çš„è¯¦ç»†æ—¥å¿—
- **é‡ç½®è§†å›¾**ï¼šç‚¹å‡»ä»»æ„å›¾è¡¨çš„"ç‚¹å‡»ç­›é€‰"æç¤ºæˆ–åˆ·æ–°é¡µé¢å¯é‡ç½®æ‰€æœ‰ç­›é€‰

### å­—æ®µæœç´¢ä¸Žç­›é€‰

1. åœ¨Discoveré¡µé¢ï¼ˆå·¦ä¾§å¯¼èˆªæ å¯è¿›å…¥ï¼‰
2. ä½¿ç”¨KQLæŸ¥è¯¢è¯­æ³•è¿›è¡Œé«˜çº§ç­›é€‰ï¼Œä¾‹å¦‚ï¼š
   - `status_code:500` - åªçœ‹æœåŠ¡å™¨é”™è¯¯
   - `response_time_ms:>1000` - æŸ¥æ‰¾æ…¢è¯·æ±‚
   - `level:ERROR AND url_path:/api/*` - APIæŽ¥å£é”™è¯¯

---

## ðŸ›  æ•°æ®æºä¸Žå­—æ®µè¯´æ˜Ž

### æ•°æ®æ¥æº

- **åº”ç”¨æ—¥å¿—**ï¼š`elk-web-app`å®¹å™¨è¾“å‡ºçš„ç»“æž„åŒ–JSONæ—¥å¿—
- **è®¿é—®æ—¥å¿—**ï¼šGunicornæœåŠ¡å™¨æ ‡å‡†çš„Nginxæ ·å¼è®¿é—®æ—¥å¿—
- **å¤„ç†ç®¡é“**ï¼šFilebeatæ”¶é›† â†’ Logstashè§£æž â†’ Elasticsearchå­˜å‚¨

### å…³é”®å­—æ®µå‚è€ƒ

| å­—æ®µå               | ç±»åž‹   | è¯´æ˜Ž             | ç¤ºä¾‹                     |
| -------------------- | ------ | ---------------- | ------------------------ |
| `@timestamp`       | æ—¥æœŸ   | æ—¥å¿—å¤„ç†æ—¶é—´     | 2025-12-07T08:01:07.653Z |
| `status_code`      | æ•´æ•°   | HTTPå“åº”çŠ¶æ€ç    | 200, 404, 500            |
| `level`            | å­—ç¬¦ä¸² | æ—¥å¿—çº§åˆ«         | INFO, WARNING, ERROR     |
| `url_path`         | å­—ç¬¦ä¸² | è¯·æ±‚è·¯å¾„         | `/api/user/123`        |
| `http_method`      | å­—ç¬¦ä¸² | HTTPæ–¹æ³•         | GET, POST                |
| `response_time_ms` | æµ®ç‚¹æ•° | å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ | 45.32                    |
| `client_ip`        | IPåœ°å€ | å®¢æˆ·ç«¯IP         | 192.168.1.100            |

---

## ðŸ” å¸¸è§ç›‘æŽ§åœºæ™¯

### åœºæ™¯ä¸€ï¼šæ—¥å¸¸å¥åº·æ£€æŸ¥

1. æ‰“å¼€ä»ªè¡¨ç›˜ï¼ŒæŸ¥çœ‹é¥¼å›¾ä¸­ç»¿è‰²éƒ¨åˆ†ï¼ˆ2xxçŠ¶æ€ç ï¼‰æ˜¯å¦å ä¸»å¯¼
2. ç¡®è®¤æŠ˜çº¿å›¾æ˜¾ç¤ºæ­£å¸¸çš„è¯·æ±‚æ³¢åŠ¨ï¼Œæ— çªç„¶éª¤é™
3. æ£€æŸ¥é”™è¯¯è¯¦æƒ…è¡¨æ˜¯å¦ä¸ºç©ºæˆ–åªæœ‰å°‘é‡å·²çŸ¥ä½Žä¼˜å…ˆçº§é”™è¯¯

### åœºæ™¯äºŒï¼šæ•…éšœåº”æ€¥å“åº”

1. å‘çŽ°é¥¼å›¾ä¸­çº¢è‰²ï¼ˆ5xxï¼‰æ¯”ä¾‹çªç„¶å¢žåŠ 
2. ç«‹å³æŸ¥çœ‹é”™è¯¯è¯¦æƒ…è¡¨ï¼Œæ‰¾åˆ°é”™è¯¯æ•°é‡æœ€å¤šçš„æŽ¥å£
3. æ ¹æ® `url_path`å’Œ `status_code`å®šä½å…·ä½“é—®é¢˜æŽ¥å£
4. ä½¿ç”¨æ—¶é—´é€‰æ‹©å™¨æŸ¥çœ‹æ•…éšœå¼€å§‹æ—¶é—´ï¼Œå…³è”éƒ¨ç½²æˆ–å˜æ›´è®°å½•

### åœºæ™¯ä¸‰ï¼šæ€§èƒ½ä¼˜åŒ–åˆ†æž

1. åœ¨Discoveré¡µé¢æœç´¢ï¼š`response_time_ms:>1000`
2. æ‰¾å‡ºæ…¢è¯·æ±‚ï¼Œåˆ†æžå…¶ `url_path`æ¨¡å¼
3. ç»“åˆ `@timestamp`æŸ¥çœ‹æ…¢è¯·æ±‚æ˜¯å¦é›†ä¸­åœ¨ç‰¹å®šæ—¶æ®µ

---

## âš ï¸ æ•…éšœæŽ’æŸ¥æŒ‡å—

### ä»ªè¡¨ç›˜æ— æ•°æ®ï¼Ÿ

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**ï¼š

   ```bash
   docker-compose ps
   ```

   ç¡®è®¤æ‰€æœ‰æœåŠ¡çŠ¶æ€ä¸º"Up"
2. **æ£€æŸ¥æ•°æ®æµæ°´çº¿**ï¼š

   - è®¿é—® http://localhost:8000/health ç”Ÿæˆæµ‹è¯•æ—¥å¿—
   - æ£€æŸ¥Filebeatæ—¥å¿—ï¼š`docker-compose logs filebeat`
   - æ£€æŸ¥Logstashå¤„ç†ï¼š`docker-compose logs logstash`
3. **è°ƒæ•´æ—¶é—´èŒƒå›´**ï¼š

   - ç¡®ä¿ä»ªè¡¨ç›˜æ—¶é—´èŒƒå›´åŒ…å«æ—¥å¿—äº§ç”Ÿæ—¶é—´
   - å°è¯•é€‰æ‹©"ä»Šå¤©"æˆ–"è¿‡åŽ»24å°æ—¶"

### å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸ï¼Ÿ

1. **å­—æ®µæ˜¾ç¤ºé—®é¢˜**ï¼š

   - åœ¨Discoveré¡µé¢éªŒè¯å­—æ®µæ˜¯å¦å­˜åœ¨
   - æ£€æŸ¥å­—æ®µåæ‹¼å†™æ˜¯å¦æ­£ç¡®ï¼ˆå¦‚ `status_code`ä¸æ˜¯ `status`ï¼‰
2. **å¯è§†åŒ–é…ç½®é—®é¢˜**ï¼š

   - ç‚¹å‡»å›¾è¡¨å³ä¸Šè§’èœå•ï¼Œé€‰æ‹©"ç¼–è¾‘"
   - æ£€æŸ¥å­—æ®µæ˜ å°„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤èšåˆæ–¹å¼ï¼ˆè®¡æ•°ã€å¹³å‡å€¼ç­‰ï¼‰ç¬¦åˆé¢„æœŸ

---

## ðŸ“ é¡¹ç›®ç»“æž„è¯´æ˜Ž

```
SimpleELK/
â”œâ”€â”€ docker-compose.yml          # æ‰€æœ‰æœåŠ¡çš„å®¹å™¨ç¼–æŽ’é…ç½®
â”œâ”€â”€ kibana/
â”‚   â””â”€â”€ kibana.yml             # Kibanaä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ logstash/
â”‚   â”œâ”€â”€ config/logstash.yml    # Logstashä¸»é…ç½®
â”‚   â””â”€â”€ pipeline/docker-logs.conf  # æ—¥å¿—å¤„ç†ç®¡é“ï¼ˆæ ¸å¿ƒè§£æžé€»è¾‘ï¼‰
â”œâ”€â”€ filebeat/filebeat.yml      # æ—¥å¿—æ”¶é›†å™¨é…ç½®
â”œâ”€â”€ elasticsearch/elasticsearch.yml # æœç´¢å¼•æ“Žé…ç½®
â””â”€â”€ web-app/                   # ç¤ºä¾‹Webåº”ç”¨ï¼ˆæ—¥å¿—æºï¼‰
    â”œâ”€â”€ app.py                 # Flaskåº”ç”¨
    â””â”€â”€ stress_test.py         # åŽ‹åŠ›æµ‹è¯•è„šæœ¬
```

---

## ðŸš¨ é‡è¦æé†’

1. **æ•°æ®ä¿ç•™ç­–ç•¥**ï¼šå½“å‰ç´¢å¼•æŒ‰æ—¥æœŸåˆ†å‰²ï¼ˆå¦‚ `webapp-logs-info-2025.12.07`ï¼‰ï¼Œé»˜è®¤ä¿ç•™æ‰€æœ‰æ•°æ®ã€‚ç”Ÿäº§çŽ¯å¢ƒåº”é€šè¿‡Elasticsearchç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆILMï¼‰ç­–ç•¥è‡ªåŠ¨æ¸…ç†æ—§æ•°æ®ã€‚
2. **å®‰å…¨æ³¨æ„äº‹é¡¹**ï¼š

   - å½“å‰é…ç½®ä¸ºå¼€å‘çŽ¯å¢ƒï¼Œå®‰å…¨åŠŸèƒ½ï¼ˆxpack.securityï¼‰å·²ç¦ç”¨
   - ç”Ÿäº§éƒ¨ç½²å‰å¿…é¡»å¯ç”¨å¯†ç è®¤è¯å’ŒHTTPS
   - é™åˆ¶å¯è®¿é—®Kibanaçš„IPèŒƒå›´
3. **æ€§èƒ½ç›‘æŽ§**ï¼š

   - ç›‘æŽ§Elasticsearché›†ç¾¤å¥åº·çŠ¶æ€ï¼š`curl http://localhost:9200/_cluster/health`
   - å®šæœŸæ£€æŸ¥ç£ç›˜ç©ºé—´ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´å­˜å‚¨æ—¥å¿—
4. **å¤‡ä»½ç­–ç•¥**ï¼š

   - å®šæœŸé€šè¿‡Kibana"Stack Management > Saved Objects"å¯¼å‡ºä»ªè¡¨ç›˜é…ç½®
   - é‡è¦ä»ªè¡¨ç›˜é…ç½®å»ºè®®ä¿å­˜ç‰ˆæœ¬è®°å½•

---

## ðŸ“ž æ”¯æŒä¸Žåé¦ˆ

å¦‚æžœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥æ—¥å¿—**ï¼š`docker-compose logs -f [æœåŠ¡å]`
2. **éªŒè¯æ•°æ®æµ**ï¼šæŒ‰"åº”ç”¨ â†’ Filebeat â†’ Logstash â†’ ES â†’ Kibana"é¡ºåºæŽ’æŸ¥
3. **æŸ¥é˜…æ–‡æ¡£**ï¼š[Elasticå®˜æ–¹æ–‡æ¡£](https://www.elastic.co/guide/index.html)
4. **é‡ç½®çŽ¯å¢ƒ**ï¼šå¦‚éœ€ä»Žå¤´å¼€å§‹ï¼Œå¯è¿è¡Œ `./cleanup.sh`ï¼ˆè°¨æ…Žæ“ä½œï¼Œä¼šåˆ é™¤æ•°æ®ï¼‰

---

**æœ€åŽæ›´æ–°**ï¼š2025å¹´12æœˆ**ç‰ˆæœ¬**ï¼š1.0.0**ç»´æŠ¤è€…**ï¼šäº‘è®¡ç®—è¯¾ç¨‹é¡¹ç›®ç»„

> è¿™ä¸ªä»ªè¡¨ç›˜æ˜¯å®žæ—¶ç›‘æŽ§ç³»ç»Ÿçš„"çœ¼ç›"ï¼Œé€šè¿‡å®ƒä¸ä»…èƒ½å‘çŽ°é—®é¢˜ï¼Œæ›´èƒ½ç†è§£ç”¨æˆ·è¡Œä¸ºã€ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚Happy Monitoring! ðŸ“ˆ
>
